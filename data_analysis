-- Group
SELECT "group" UNIQUE FROM "default"."basic_electrical_generation_data_dom_rep";

#	group
1	Térmica
2	Hidroeléctrica
3	Eólica
4	Totales
5	Solar

-- Companies
SELECT distinct "company" FROM "default"."basic_electrical_generation_data_dom_rep";

#	company
1	GPLV
2	GRUPO EÓLICO DOMINICANO
3	SAN FELIPE
4	PVDC
5	BERSAL
6	GPLVEG
7	PHINIE & CO DEVELOPMENT S.R.L. 
8	KARPOWERSHIP DOMINICAN REPUBLIC, S.A.S.
9	CEPP
10	PECASA
11	EMERALD
12	EGEHID
13	POSEIDON
14	ENREN
15	ELECTRONIC
16	IC POWER
17	AGUA CLARA
18	SAN PEDRO BIO-ENERGY
19	AES ANDRES
20	EGE-HAINA
21	EGE-ITABO
22	MONTERIO
23	LAESA
24	CDEEE
25	LEAR
26	MONTECRISTI SOLAR
27	SIBA
28	EGE-HIDRO
29	LAESA LTD
30	EGEHAINA
31	METALDOM
32	MATRISOL, S.A.S.
33	EMPRESA DE GENERACIÓN ELÉCTRICA PUNTA CATALINA
34	WCG
35	SEABOARD
36	LOS ORIGENES
37	AES DOMINICANA RENEWABLE ENERGY, S.R.L.
38	PARQUE EOLICO BEATA
39	CESPM
40	EFD ECOENER FOTOVOLTAICA DOMINICANA, S.R.L.
41	FIDEICOMISO CTPC
42	DPP
43	EGEITABO
44	KOROR BUSINESS, S.R.L.
45	CAYMAN POWER BARGE
46	Total
47	MONTE RIO LTD

-- Distinct plants
SELECT distinct "plant" FROM "default"."basic_electrical_generation_data_dom_rep";

#	plant
1	AES ANDRES
3	AES ANDRÉS FO
4	AES ANDRÉS GN
2	AES ANDRES xxxxxx
5	AGUACATE 1
6	AGUACATE 2
7	ANIANA VARGAS 1
8	ANIANA VARGAS 2
9	ARROYO BARRIL
10	BAIGUAQUE 1
11	BAIGUAQUE 2
12	BARAHONA CARBON
13	BARAHONA CARBÓN
14	BERSAL
15	BRAZO DERECHO
16	CAYMAN
17	CENTRAL HIDROELECTRICA HATILLO 2
18	CEPP 1
19	CEPP 2
20	CESPM 1
21	CESPM 1 FO
22	CESPM 1 GN
23	CESPM 2
24	CESPM 2 FO
25	CESPM 2 GN
26	CESPM 3
27	CESPM 3 FO
28	CESPM 3 GN
33	Consumo
29	CONTRA EMBALSE MONCION 1
31	CONTRA EMBALSE MONCIÓN 1
30	CONTRA EMBALSE MONCION 2
32	CONTRA EMBALSE MONCIÓN 2
34	DAJABON
39	Disponibilidad Real
40	Disponibilidad Real Sinc.
35	DOMINGO RODRIGUEZ 1
37	DOMINGO RODRÍGUEZ 1
36	DOMINGO RODRIGUEZ 2
38	DOMINGO RODRÍGUEZ 2
41	EL SALTO
42	ESTRELLA DEL MAR
43	ESTRELLA DEL MAR 2 CFO
44	ESTRELLA DEL MAR 2 CGN
45	ESTRELLA DEL MAR 2 SFO
46	ESTRELLA DEL MAR 2 SGN
47	ESTRELLA DEL MAR 3
48	ESTRELLA DEL MAR 3 CCP
49	ESTRELLA DEL MAR 3 CCT
50	ESTRELLA DEL MAR 3 CS
51	ESTRELLA DEL MAR 3 SGN
52	GENERACIÓN DE EMERGENCIA AES ANDRÉS
53	HAINA 1
54	HAINA 2
55	HAINA 3
56	HAINA 4
57	HAINA TG
58	HATILLO
59	HATILLO 2
60	INCA KM22
61	ITABO 1
62	ITABO 2
63	JIGUEY 1
64	JIGUEY 2
65	JIMENOA
66	JUANCHO LOS COCOS 1
67	LA VEGA
68	LAS BARIAS
69	LAS BARÍAS
70	LAS DAMAS
71	LOPEZ ANGOSTURA
84	LÓPEZ ANGOSTURA
72	LOS ANONES
73	LOS COCOS 2
74	LOS MINA 1
75	LOS MINA 2
76	LOS MINA 5
77	LOS MINA 6
78	LOS MINA 7
79	LOS ORIGENES
80	LOS ORÍGENES POWER PLANT FUEL OIL
81	LOS ORÍGENES POWER PLANT GAS NATURAL
82	LOS TOROS 1
83	LOS TOROS 2
85	MAGUEYAL 1
86	MAGUEYAL 2
87	METALDOM
88	MONCION 1
90	MONCIÓN 1
89	MONCION 2
91	MONCIÓN 2
92	MONTE PLATA SOLAR
93	MONTE RIO
94	MONTE RÍO
95	NIZAO NAJAYO
96	PALAMARA
97	PALENQUE
98	PALOMINO 1
99	PALOMINO 2
100	PARQUE ENERGETICO LOS MINA CC PARCIAL

-- piechart
SELECT "group", SUM(energy) AS total_energy
FROM "default"."basic_electrical_generation_data_dom_rep"
WHERE "group" != 'Totales'
  AND datetime BETWEEN '2023-11-01T00:00:00' AND '2023-11-01T00:00:00'
GROUP BY "group";


#	group	total_energy
1	Eólica	199581.860000000
4	Hidroeléctrica	289798.840000000
3	Solar	202295.400000000
2	Térmica	3168018.030000000


SELECT SUM(total_energy) AS Total FROM (
SELECT "group", SUM(energy) AS total_energy
FROM "default"."basic_electrical_generation_data_dom_rep"
WHERE "group" != 'Totales'
  AND datetime BETWEEN '2023-11-01T00:00:00' AND '2023-12-31T23:59:59'
GROUP BY "group");